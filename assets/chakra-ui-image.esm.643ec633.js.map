{"version":3,"file":"chakra-ui-image.esm.643ec633.js","sources":["../../../../node_modules/@chakra-ui/image/dist/chakra-ui-image.esm.js"],"sourcesContent":["import { forwardRef, chakra } from '@chakra-ui/system';\nimport { omit, __DEV__ } from '@chakra-ui/utils';\nimport * as React from 'react';\nimport { useState, useEffect, useRef, useCallback } from 'react';\nimport { useSafeLayoutEffect } from '@chakra-ui/hooks';\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\n/**\n * React hook that loads an image in the browser,\n * and lets us know the `status` so we can show image\n * fallback if it is still `pending`\n *\n * @returns the status of the image loading progress\n *\n * @example\n *\n * ```jsx\n * function App(){\n *   const status = useImage({ src: \"image.png\" })\n *   return status === \"loaded\" ? <img src=\"image.png\" /> : <Placeholder />\n * }\n * ```\n */\nfunction useImage(props) {\n  var loading = props.loading,\n      src = props.src,\n      srcSet = props.srcSet,\n      onLoad = props.onLoad,\n      onError = props.onError,\n      crossOrigin = props.crossOrigin,\n      sizes = props.sizes,\n      ignoreFallback = props.ignoreFallback;\n\n  var _useState = useState(\"pending\"),\n      status = _useState[0],\n      setStatus = _useState[1];\n\n  useEffect(function () {\n    setStatus(src ? \"loading\" : \"pending\");\n  }, [src]);\n  var imageRef = useRef();\n  var load = useCallback(function () {\n    if (!src) return;\n    flush();\n    var img = new Image();\n    img.src = src;\n    if (crossOrigin) img.crossOrigin = crossOrigin;\n    if (srcSet) img.srcset = srcSet;\n    if (sizes) img.sizes = sizes;\n    if (loading) img.loading = loading;\n\n    img.onload = function (event) {\n      flush();\n      setStatus(\"loaded\");\n      onLoad == null ? void 0 : onLoad(event);\n    };\n\n    img.onerror = function (error) {\n      flush();\n      setStatus(\"failed\");\n      onError == null ? void 0 : onError(error);\n    };\n\n    imageRef.current = img;\n  }, [src, crossOrigin, srcSet, sizes, onLoad, onError, loading]);\n\n  var flush = function flush() {\n    if (imageRef.current) {\n      imageRef.current.onload = null;\n      imageRef.current.onerror = null;\n      imageRef.current = null;\n    }\n  };\n\n  useSafeLayoutEffect(function () {\n    /**\n     * If user opts out of the fallback/placeholder\n     * logic, let's bail out.\n     */\n    if (ignoreFallback) return undefined;\n\n    if (status === \"loading\") {\n      load();\n    }\n\n    return function () {\n      flush();\n    };\n  }, [status, load, ignoreFallback]);\n  /**\n   * If user opts out of the fallback/placeholder\n   * logic, let's just return 'loaded'\n   */\n\n  return ignoreFallback ? \"loaded\" : status;\n}\n\nvar _excluded = [\"htmlWidth\", \"htmlHeight\", \"alt\"],\n    _excluded2 = [\"fallbackSrc\", \"fallback\", \"src\", \"srcSet\", \"align\", \"fit\", \"loading\", \"ignoreFallback\", \"crossOrigin\"];\nvar NativeImage = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var htmlWidth = props.htmlWidth,\n      htmlHeight = props.htmlHeight,\n      alt = props.alt,\n      rest = _objectWithoutPropertiesLoose(props, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"img\", _extends({\n    width: htmlWidth,\n    height: htmlHeight,\n    ref: ref,\n    alt: alt\n  }, rest));\n});\n\n/**\n * React component that renders an image with support\n * for fallbacks\n *\n * @see Docs https://chakra-ui.com/image\n */\nvar Image$1 = /*#__PURE__*/forwardRef(function (props, ref) {\n  var fallbackSrc = props.fallbackSrc,\n      fallback = props.fallback,\n      src = props.src,\n      srcSet = props.srcSet,\n      align = props.align,\n      fit = props.fit,\n      loading = props.loading,\n      ignoreFallback = props.ignoreFallback,\n      crossOrigin = props.crossOrigin,\n      rest = _objectWithoutPropertiesLoose(props, _excluded2);\n  /**\n   * Defer to native `img` tag if `loading` prop is passed\n   * @see https://github.com/chakra-ui/chakra-ui/issues/1027\n   */\n\n\n  var shouldIgnore = loading != null || ignoreFallback || fallbackSrc === undefined && fallback === undefined; // if the user doesn't provide any kind of fallback we should ignore it\n\n  var status = useImage(_extends({}, props, {\n    ignoreFallback: shouldIgnore\n  }));\n\n  var shared = _extends({\n    ref: ref,\n    objectFit: fit,\n    objectPosition: align\n  }, shouldIgnore ? rest : omit(rest, [\"onError\", \"onLoad\"]));\n\n  if (status !== \"loaded\") {\n    /**\n     * If user passed a custom fallback component,\n     * let's render it here.\n     */\n    if (fallback) return fallback;\n    return /*#__PURE__*/React.createElement(chakra.img, _extends({\n      as: NativeImage,\n      className: \"chakra-image__placeholder\",\n      src: fallbackSrc\n    }, shared));\n  }\n\n  return /*#__PURE__*/React.createElement(chakra.img, _extends({\n    as: NativeImage,\n    src: src,\n    srcSet: srcSet,\n    crossOrigin: crossOrigin,\n    loading: loading,\n    className: \"chakra-image\"\n  }, shared));\n});\n\n/**\n * Fallback component for most SSR users who want to use the native `img` with\n * support for chakra props\n */\nvar Img = /*#__PURE__*/forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(chakra.img, _extends({\n    ref: ref,\n    as: NativeImage,\n    className: \"chakra-image\"\n  }, props));\n});\n\nif (__DEV__) {\n  Image$1.displayName = \"Image\";\n}\n\nexport { Image$1 as Image, Img, useImage };\n"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","useImage","props","loading","src","srcSet","onLoad","onError","crossOrigin","sizes","ignoreFallback","_useState","useState","status","setStatus","useEffect","imageRef","useRef","load","useCallback","flush","img","Image","srcset","onload","event","onerror","error","current","useSafeLayoutEffect","undefined","_excluded","_excluded2","NativeImage","React","ref","htmlWidth","htmlHeight","alt","rest","_jsx","Image$1","forwardRef","fallbackSrc","fallback","align","fit","shouldIgnore","shared","objectFit","objectPosition","omit","chakra","as","className","__DEV__","displayName"],"mappings":"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"}